model AdmissionRound {
  admissionRoundId   Int           @id @default(autoincrement()) @map("admission_round_id")
  admissionRound     Int           @map("admission_round")
  admissionRoundName String?       @map("admission_round_name") @db.VarChar(100)
  factStudent        FactStudent[]

  @@map("admission_round")
}

model Building {
  buildingId   Int     @id @default(autoincrement()) @map("building_Id")
  buildingName String? @map("building_name") @db.VarChar(255)
  buildingCode String  @map("building_code") @db.VarChar(10)
  room         Room[]

  @@map("building")
}

model Classroom {
  roomId    Int       @map("room_id")
  classId   Int       @map("class_id")
  factClass FactClass @relation(fields: [classId], references: [classId], onDelete: Cascade, map: "fk_classroom_class")
  room      Room      @relation(fields: [roomId], references: [roomId], onDelete: Cascade, map: "fk_classroom_room")

  @@id([roomId, classId])
  @@index([classId], map: "idx_class_id")
  @@map("classroom")
}

model Department {
  deptId      Int           @id @default(autoincrement()) @map("dept_id")
  deptCode    String        @map("dept_code") @db.VarChar(10)
  deptName    String        @map("dept_name") @db.VarChar(30)
  deptAliasTh String        @map("dept_alias_th") @db.VarChar(20)
  course      Course[]
  factStudent FactStudent[]
  teacher     Teacher[]

  @@map("department")
}

model DimDate {
  dateKey       Int             @id @map("date_key")
  fullDate      DateTime        @map("full_date") @db.Date
  day           Int
  dayName       String          @map("day_name") @db.VarChar(20)
  dayOfWeek     Int             @map("day_of_week")
  weekNumber    Int             @map("week_number")
  weekStartDate DateTime        @map("week_start_date") @db.Date
  weekEndDate   DateTime        @map("week_end_date") @db.Date
  month         Int
  monthName     String          @map("month_name") @db.VarChar(20)
  quarter       Int
  year          Int
  isWeekend     Boolean         @map("is_weekend")
  factRoomUsage FactRoomUsage[]

  @@map("dim_date")
}

model FactClass {
  classId          Int                    @id @default(autoincrement()) @map("class_id")
  subjectId        Int?                   @map("subject_id")
  courseId         Int?                   @map("course_id")
  sec              Int?                   @map("sec")
  secType          FactClassSecType?      @map("sec_type")
  classCapacity    Int?                   @map("class_capacity")
  semesterYear     Int?                   @map("semester_year") @db.Year
  semesterPart     FactClassSemesterPart? @map("semester_part")
  daysBit          String                 @map("days_bit") @db.Char(7)
  classtime1       String?                @map("classtime1") @db.Char(48)
  classtime2       String?                @map("classtime2") @db.Char(48)
  classHr          Decimal?               @map("class_hr") @db.Decimal(6, 2)
  createdAt        DateTime               @default(now()) @map("created_at") @db.Timestamp(0)
  isCurrent        Boolean?               @default(true) @map("is_current")
  effectiveStartTs DateTime               @default(now()) @map("effective_start_ts") @db.Timestamp(0)
  effectiveEndTs   DateTime?              @map("effective_end_ts") @db.Timestamp(0)
  changeComment    String?                @map("change_comment") @db.VarChar(255)
  classroom        Classroom[]
  course           Course?                @relation(fields: [courseId], references: [courseId], onDelete: Restrict, map: "fact_class_ibfk_1")
  subject          Subject?               @relation(fields: [subjectId], references: [subjectId], onDelete: Restrict, map: "fk_fact_class_subject")
  factRegister     FactRegister[]
  factRoomUsage    FactRoomUsage[]
  lecturer         Lecturer[]

  @@unique([subjectId, courseId, sec, semesterYear, semesterPart], map: "uq_class_identity")
  @@index([subjectId], map: "idx_subject")
  @@index([courseId], map: "idx_course")
  @@index([semesterYear, semesterPart], map: "idx_semester")
  @@map("fact_class")
}

model FactLeave {
  factLeaveId         Int                  @unique(map: "fact_leave_id") @default(autoincrement()) @map("fact_leave_id")
  leaveTypeId         Int                  @map("leave_type_id")
  studentId           Int                  @map("student_id")
  advisorId           Int                  @map("advisor_id")
  type                FactLeaveType        @map("type")
  dateStart           DateTime?            @map("date_start") @db.Date
  dateEnd             DateTime?            @map("date_end") @db.Date
  totalDay            Int                  @map("total_day")
  leaveReason         String?              @map("leave_reason") @db.Text
  rejectReason        String?              @map("reject_reason") @db.Text
  statusFinal         FactLeaveStatusFinal @default(Pending) @map("status_final")
  filePath            String?              @map("file_path") @db.VarChar(255)
  createdAt           DateTime             @default(now()) @map("created_at") @db.Timestamp(0)
  addressDetail       String?              @map("address_detail") @db.Text
  phone               String?              @map("phone") @db.VarChar(10)
  email               String?              @map("email") @db.VarChar(255)
  approveAdvisorAt    DateTime?            @map("approve_advisor_at") @db.Timestamp(0)
  approveDepartHeadAt DateTime?            @map("approve_depart_head_at") @db.Timestamp(0)
  approveDeanAt       DateTime?            @map("approve_dean_at") @db.Timestamp(0)
  teacher             Teacher              @relation(fields: [advisorId], references: [teacherId], onUpdate: Restrict, map: "advisor_teacher_id_ibfk")
  leaveType           LeaveType            @relation(fields: [leaveTypeId], references: [leaveTypeId], onUpdate: Restrict, map: "fact_leave_ibfk_1")
  student             Student              @relation(fields: [studentId], references: [studentId], onUpdate: Restrict, map: "fact_leave_ibfk_2")
  factLeaveSubject    FactLeaveSubject[]

  @@id([factLeaveId, leaveTypeId])
  @@index([advisorId], map: "advisor_teacher_id")
  @@index([factLeaveId, leaveTypeId], map: "fact_leave_index_0")
  @@index([leaveTypeId], map: "leave_type_id")
  @@index([studentId], map: "student_id")
  @@map("fact_leave")
}

model FactLeaveSubject {
  factLeaveSubjectId Int            @id @unique(map: "fact_leave_subject_id") @default(autoincrement()) @map("fact_leave_subject_id")
  factLeaveId        Int?           @map("fact_leave_id")
  factRegisId        Int?           @map("fact_regis_id")
  factRoomUsageId    Int?           @map("fact_room_usage_id")
  factLeave          FactLeave?     @relation(fields: [factLeaveId], references: [factLeaveId], onDelete: Restrict, onUpdate: Restrict, map: "fact_leave_subject_ibfk_1")
  factRegister       FactRegister?  @relation(fields: [factRegisId], references: [regisId], onDelete: Restrict, onUpdate: Restrict, map: "fact_register_leave-subject_ibfk")
  factRoomUsage      FactRoomUsage? @relation(fields: [factRoomUsageId], references: [roomUsageId], onDelete: Restrict, onUpdate: Restrict, map: "fact_room_usage_leave-subject_ibfk")

  @@index([factLeaveId], map: "fact_leave_id")
  @@index([factLeaveSubjectId], map: "fact_register_id")
  @@index([factRegisId], map: "fact_register_leave-subject_ibfk")
  @@index([factRoomUsageId], map: "fact_room_usage_id")
  @@map("fact_leave_subject")
}

model FactRoomUsage {
  roomUsageId      Int                @id @default(autoincrement()) @map("room_usage_id")
  dateKey          Int                @map("date_key")
  classId          Int?               @map("class_id")
  roomId           Int                @map("room_id")
  teacherId        Int?               @map("teacher_id")
  week             Int                @map("week")
  createdAt        DateTime           @default(now()) @map("created_at") @db.Timestamp(0)
  isCurrent        Boolean?           @default(true) @map("is_current")
  effectiveStartTs DateTime           @default(now()) @map("effective_start_ts") @db.Timestamp(0)
  effectiveEndTs   DateTime?          @map("effective_end_ts") @db.Timestamp(0)
  changeComment    String?            @map("change_comment") @db.VarChar(255)
  factLeaveSubject FactLeaveSubject[]
  factClass        FactClass?         @relation(fields: [classId], references: [classId], onDelete: Restrict, onUpdate: Restrict, map: "fk_room_usage_class")
  dimDate          DimDate            @relation(fields: [dateKey], references: [dateKey], map: "fk_room_usage_date")
  room             Room               @relation(fields: [roomId], references: [roomId], map: "fk_room_usage_room")
  teacher          Teacher?           @relation(fields: [teacherId], references: [teacherId], onDelete: Restrict, map: "fk_room_usage_teacher")

  @@unique([dateKey, roomId, isCurrent], map: "uq_room_usage_current")
  @@index([classId], map: "idx_class")
  @@index([dateKey], map: "idx_date")
  @@index([roomId], map: "idx_room")
  @@index([teacherId], map: "idx_teacher")
  @@map("fact_room_usage")
}

model FactStudent {
  studentId        Int            @map("student_id")
  schoolId         Int            @map("school_id")
  departmentId     Int            @map("department_id")
  programId        Int            @map("program_id")
  teacherId        Int            @map("teacher_id")
  coursePlanId     Int            @map("course_plan_id")
  admissionRoundId Int            @map("admission_round_id")
  studentStatusId  Int            @map("student_status_id")
  admissionYear    Int            @map("admission_year")
  studyGeneration  Int            @map("study_generation")
  school           School         @relation(fields: [schoolId], references: [schoolId], onUpdate: Restrict, map: "fact_student_ibfk_1")
  studentStatus    StudentStatus  @relation(fields: [studentStatusId], references: [studentStatusId], onUpdate: Restrict, map: "fact_student_ibfk_10")
  program          Program        @relation(fields: [programId], references: [programId], onUpdate: Restrict, map: "fact_student_ibfk_3")
  admissionRound   AdmissionRound @relation(fields: [admissionRoundId], references: [admissionRoundId], onUpdate: Restrict, map: "fact_student_ibfk_4")
  department       Department     @relation(fields: [departmentId], references: [deptId], onUpdate: Restrict, map: "fact_student_ibfk_6")
  teacher          Teacher        @relation(fields: [teacherId], references: [teacherId], onUpdate: Restrict, map: "fact_student_ibfk_7")
  coursePlan       CoursePlan     @relation(fields: [coursePlanId], references: [coursePlanId], onUpdate: Restrict, map: "fact_student_ibfk_8")
  student          Student        @relation(fields: [studentId], references: [studentId], onDelete: Cascade, map: "fact_student_ibfk_9")

  @@id([studentId, schoolId, studentStatusId, departmentId, programId, teacherId, coursePlanId, admissionRoundId])
  @@index([admissionRoundId], map: "admission_round_id")
  @@index([coursePlanId], map: "course_id")
  @@index([departmentId], map: "department_id")
  @@index([studentStatusId], map: "fact_student_ibfk_10")
  @@index([programId], map: "program_id")
  @@index([schoolId], map: "school_id")
  @@index([teacherId], map: "teacher_id")
  @@map("fact_student")
}

model LeaveType {
  leaveTypeId Int           @id @default(autoincrement()) @map("leave_type_id")
  type        LeaveTypeType @map("type")
  minDay      Int           @map("min_day")
  required    Int           @default(0) @map("required") @db.TinyInt
  factLeave   FactLeave[]

  @@map("leave_type")
}

model Lecturer {
  teacherId Int       @map("teacher_id")
  classId   Int       @map("class_id")
  factClass FactClass @relation(fields: [classId], references: [classId], onUpdate: Restrict, map: "fk_lecturer_class")
  teacher   Teacher   @relation(fields: [teacherId], references: [teacherId], onDelete: Cascade, map: "fk_lecturer_teacher")

  @@id([teacherId, classId])
  @@index([classId], map: "idx_class_id")
  @@index([teacherId], map: "idx_teacher_id")
  @@map("lecturer")
}

model Program {
  programId   Int           @id @default(autoincrement()) @map("program_id")
  langProgram String        @map("lang_program") @db.VarChar(20)
  nameProgram String        @map("name_program") @db.VarChar(20)
  factStudent FactStudent[]

  @@map("program")
}

model Province {
  provinceId   Int      @id @default(autoincrement()) @map("province_id")
  provinceName String   @map("province_name") @db.VarChar(50)
  regionId     Int      @map("region_id")
  region       Region   @relation(fields: [regionId], references: [regionId], onDelete: Cascade, map: "province_ibfk_1")
  school       School[]

  @@index([regionId], map: "region_id")
  @@map("province")
}

model Region {
  regionId   Int        @id @default(autoincrement()) @map("region_id")
  regionName String     @map("region_name") @db.VarChar(30)
  province   Province[]

  @@map("region")
}

model Room {
  roomId             Int             @id @default(autoincrement()) @map("room_Id")
  buildingBuildingId Int?            @map("building_building_Id")
  roomCode           String          @map("room_code") @db.VarChar(10)
  roomCapacity       Decimal?        @map("room_capacity") @db.Decimal(10, 0)
  roomType           RoomRoomType?   @map("room_type")
  classroom          Classroom[]
  factRoomUsage      FactRoomUsage[]
  building           Building?       @relation(fields: [buildingBuildingId], references: [buildingId], map: "fk_room_building1")

  @@index([buildingBuildingId], map: "fk_room_building1")
  @@map("room")
}

model School {
  schoolId    Int           @id @default(autoincrement()) @map("school_id")
  schoolName  String        @map("school_name") @db.VarChar(150)
  provinceId  Int           @map("province_id")
  factStudent FactStudent[]
  province    Province      @relation(fields: [provinceId], references: [provinceId], onDelete: Cascade, map: "school_ibfk_1")

  @@index([provinceId], map: "province_id")
  @@map("school")
}

model SubCredit {
  subCreditId  Int       @id @default(autoincrement()) @map("sub_credit_id")
  credit       Int       @map("credit")
  lectureHours Int       @map("lecture_hours")
  labHours     Int       @map("lab_hours")
  bySelfHours  Int       @map("by_self_hours")
  subject      Subject[]

  @@map("sub_credit")
}

model Course {
  courseId              Int               @id @default(autoincrement()) @map("course_id")
  nameCourseTh          String            @map("name_course_th") @db.VarChar(150)
  nameCourseUse         String            @map("name_course_use") @db.VarChar(50)
  nameCourseEng         String            @map("name_course_eng") @db.VarChar(150)
  nameFullDegreeTh      String            @map("name_full_degree_th") @db.VarChar(150)
  nameFullDegreeEng     String            @map("name_full_degree_eng") @db.VarChar(150)
  nameInitialsDegreeTh  String            @map("name_initials_degree_th") @db.VarChar(100)
  nameInitialsDegreeEng String            @map("name_initials_degree_eng") @db.VarChar(100)
  departmentId          Int               @map("department_id")
  department            Department        @relation(fields: [departmentId], references: [deptId], onDelete: Cascade, map: "fk_course_department")
  coursePlan            CoursePlan[]
  factClass             FactClass[]
  subject               Subject[]
  subjectCategory       SubjectCategory[]

  @@index([departmentId], map: "fk_course_department")
  @@map("course")
}

model SubjectType {
  subjectTypeId   Int       @id @default(autoincrement()) @map("subject_type_id")
  nameSubjectType String    @map("name_subject_type") @db.VarChar(20)
  subject         Subject[]

  @@map("subject_type")
}

model Teacher {
  teacherId       Int               @id @default(autoincrement()) @map("teacher_id")
  username        String            @map("username") @db.VarChar(20)
  teacherCode     String?           @map("teacher_code") @db.VarChar(10)
  teacherNameTh   String            @map("teacher_name_th") @db.VarChar(255)
  teacherNameEng  String            @map("teacher_name_eng") @db.VarChar(255)
  alias           String            @map("alias") @db.VarChar(255)
  departmentId    Int               @map("department_id")
  facultyCheck    Int               @map("faculty_check")
  factLeave       FactLeave[]
  factRoomUsage   FactRoomUsage[]
  factStudent     FactStudent[]
  factTermSummary FactTermSummary[]
  lecturer        Lecturer[]
  department      Department        @relation(fields: [departmentId], references: [deptId], onDelete: Cascade, map: "teacher_ibfk_1")

  @@index([departmentId], map: "department_id")
  @@index([teacherId, teacherCode], map: "teacher_id_teacher_code")
  @@map("teacher")
}

model Affiliations {
  id              Int     @id @default(autoincrement())
  affiliationName String? @map("affiliation_name") @db.VarChar(1000)

  @@map("affiliations")
}

model Authors {
  id             Int     @id @default(autoincrement())
  scopusAuthorId String? @unique(map: "scopus_author_id") @map("scopus_author_id") @db.VarChar(50)
  firstname      String? @db.VarChar(255)
  lastname       String? @db.VarChar(255)

  @@map("authors")
}

model DocumentTypes {
  id               Int     @id @default(autoincrement())
  documentTypeName String? @unique(map: "document_type_name") @map("document_type_name") @db.VarChar(50)

  @@map("document_types")
}

model Issns {
  id        Int    @id @default(autoincrement())
  value     String @db.VarChar(20)
  journalId Int    @map("journal_id")

  @@unique([value, journalId], map: "unique_issn_for_journal")
  @@index([journalId], map: "journal_id")
  @@map("issns")
}

model Journals {
  id    Int    @id @default(autoincrement())
  title String @unique(map: "title") @db.VarChar(255)

  @@map("journals")
}

model Keywords {
  id          Int     @id @default(autoincrement())
  keywordText String? @map("keyword_text") @db.VarChar(255)
  type        String? @db.VarChar(10)

  @@unique([keywordText, type])
  @@map("keywords")
}

model Publishers {
  id            Int     @id @default(autoincrement())
  publisherName String? @unique(map: "publisher_name") @map("publisher_name") @db.VarChar(255)

  @@map("publishers")
}

model Research {
  id             Int     @id @default(autoincrement())
  title          String? @db.VarChar(1000)
  year           Int?
  citedBy        Int?    @map("cited_by")
  doi            String? @unique(map: "doi") @db.VarChar(255)
  link           String? @db.VarChar(2083)
  abstract       String? @db.VarChar(5000)
  isbn           String? @db.VarChar(255)
  language       String? @db.VarChar(255)
  documentTypeId Int?    @map("document_type_id")
  publisherId    Int?    @map("publisher_id")
  sourceId       Int?    @map("source_id")
  journalId      Int?    @map("journal_id")

  @@index([documentTypeId], map: "document_type_id")
  @@index([journalId], map: "journal_id")
  @@index([publisherId], map: "publisher_id")
  @@index([sourceId], map: "source_id")
  @@map("research")
}

model ResearchAffiliations {
  id            Int  @id @default(autoincrement())
  researchId    Int? @map("research_id")
  affiliationId Int? @map("affiliation_id")

  @@unique([researchId, affiliationId], map: "unique_research_affiliation")
  @@index([affiliationId], map: "affiliation_id")
  @@map("research_affiliations")
}

model ResearchAuthors {
  id          Int  @id @default(autoincrement())
  researchId  Int? @map("research_id")
  authorId    Int? @map("author_id")
  authorOrder Int? @map("author_order")

  @@unique([researchId, authorId], map: "unique_research_author")
  @@index([authorId], map: "author_id")
  @@map("research_authors")
}

model ResearchKeywords {
  id         Int  @id @default(autoincrement())
  researchId Int? @map("research_id")
  keywordId  Int? @map("keyword_id")

  @@unique([researchId, keywordId], map: "unique_research_keyword")
  @@index([keywordId], map: "keyword_id")
  @@map("research_keywords")
}

model Sources {
  id         Int     @id @default(autoincrement())
  sourceName String? @unique(map: "source_name") @map("source_name") @db.VarChar(50)

  @@map("sources")
}
